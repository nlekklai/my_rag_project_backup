# config/global_vars.py
import os
import uuid
from typing import List, Dict, Set, Final
import torch
from dotenv import load_dotenv

load_dotenv()

# ================================================================
# Project & Namespace
# ================================================================
PROJECT_NAMESPACE_UUID: Final[uuid.UUID] = uuid.UUID(
    "f77c38c0-f213-4318-ae38-e69c73e97022"
)

PROJECT_ROOT: Final[str] = os.path.dirname(
    os.path.dirname(os.path.abspath(__file__))
)

DATA_STORE_ROOT: Final[str] = os.path.join(PROJECT_ROOT, "data_store")

# ================================================================
# Tenant & Default Configuration
# ================================================================
DEFAULT_TENANT: Final[str] = "pea"
DEFAULT_YEAR: Final[int] = 2568
DEFAULT_ENABLER: Final[str] = "KM"


# ================================================================
# Device & Hardware Acceleration
# ================================================================
# ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å cuda (Server), mps (Mac M1/M2), ‡∏´‡∏£‡∏∑‡∏≠ cpu (‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ) ‡πÄ‡∏≠‡∏á
if torch.cuda.is_available():
    TARGET_DEVICE: Final[str] = "cuda"
elif hasattr(torch.backends, "mps") and torch.backends.mps.is_available():
    TARGET_DEVICE: Final[str] = "mps"
else:
    TARGET_DEVICE: Final[str] = "cpu"

# ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Batch Size ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏£‡∏á‡∏Ç‡∏≠‡∏á Device
# L40S (cuda) ‡πÉ‡∏ä‡πâ 32, Mac (mps) ‡πÉ‡∏ä‡πâ 8, CPU ‡πÉ‡∏ä‡πâ 4
if TARGET_DEVICE == "cuda":
    DEFAULT_EMBED_BATCH_SIZE: Final[int] = 32
elif TARGET_DEVICE == "mps":
    DEFAULT_EMBED_BATCH_SIZE: Final[int] = 8
else:
    DEFAULT_EMBED_BATCH_SIZE: Final[int] = 4

# ================================================================
# Ollama / LLM Request Control
# ================================================================
OLLAMA_REQUEST_TIMEOUT: Final[int] = 300  # seconds
OLLAMA_MAX_RETRIES: Final[int] = 3

# ================================================================
# Run Mode & LLM Configuration
# ================================================================
# ‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏´‡∏°‡∏î (‡∏ã‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô LOCAL_OLLAMA ‡πÄ‡∏™‡∏°‡∏≠)
RAG_RUN_MODE: Final[str] = os.environ.get("RAG_RUN_MODE", "LOCAL_OLLAMA")

# ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠ Model ‡πÅ‡∏•‡∏∞ Context ‡∏à‡∏≤‡∏Å .env
# ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô .env ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ 8b ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Mac
DEFAULT_LLM_MODEL_NAME: Final[str] = os.environ.get("OLLAMA_MODEL_NAME", "llama3:8b")
LLM_CONTEXT_WINDOW: Final[int] = int(os.environ.get("LLM_CONTEXT_WINDOW", "8192"))

# ‡∏î‡∏∂‡∏á URL ‡∏Ç‡∏≠‡∏á Ollama (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï Mac ‡∏≠‡∏¢‡∏≤‡∏Å‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏´‡∏≤ Server)
OLLAMA_BASE_URL: Final[str] = os.environ.get("OLLAMA_BASE_URL", "http://localhost:11434")

# ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Workers (Mac ‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ 2, Server L40S ‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ 8)
MAX_PARALLEL_WORKERS: Final[int] = int(os.environ.get("MAX_PARALLEL_WORKERS", "2"))

LLM_TEMPERATURE: Final[float] = 0.0

# ================================================================
# Embedding & Reranker Models
# ================================================================
EMBEDDING_MODEL_NAME: Final[str] = "BAAI/bge-m3"
RERANKER_MODEL_NAME: Final[str] = os.getenv("RERANKER_MODEL_NAME", "BAAI/bge-reranker-base")

# üéØ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏Ñ‡∏£‡∏±‡∏ö
EMBEDDING_MODEL_KWARGS: Final[Dict] = {
    "device": TARGET_DEVICE,
    "trust_remote_code": True  # ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞ Meta Tensor
}

EMBEDDING_ENCODE_KWARGS: Final[Dict] = {
    "normalize_embeddings": True,
    "batch_size": DEFAULT_EMBED_BATCH_SIZE # ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≤‡∏° Device ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
}

# ================================================================
# Hybrid Search Configuration
# ================================================================
USE_HYBRID_SEARCH: Final[bool] = True
HYBRID_VECTOR_WEIGHT: Final[float] = 0.7
HYBRID_BM25_WEIGHT: Final[float] = 0.3


# ================================================================
# Retrieval & Ranking Parameters
# ================================================================
# üéØ [NEW] ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô (Mac vs Server) ‡∏ú‡πà‡∏≤‡∏ô .env
# INITIAL_TOP_K: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å ChromaDB ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô
INITIAL_TOP_K: Final[int] = int(os.environ.get("INITIAL_TOP_K", "75"))

# RETRIEVAL_TOP_K: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô Analysis/Consultant (‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°)
# ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: Mac=150-200, Server=300-500
RETRIEVAL_TOP_K: Final[int] = int(os.environ.get("RETRIEVAL_TOP_K", "500"))

# ANALYSIS_FINAL_K: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Chunk ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ LLM ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå (‡∏´‡∏•‡∏±‡∏á Rerank)
# ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: Mac=12-15 (‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î RAM), Server=25-35 (‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)
ANALYSIS_FINAL_K: Final[int] = int(os.environ.get("ANALYSIS_FINAL_K", "15"))
# üéØ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Chunk ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (General QA)
QA_FINAL_K: Final[int] = int(os.environ.get("QA_FINAL_K", "30"))

# ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö General QA
FINAL_K_RERANKED: Final[int] = int(os.environ.get("FINAL_K_RERANKED", "15"))
FINAL_K_NON_RERANKED: Final[int] = 7


RERANK_THRESHOLD: Final[float] = 0.5
MIN_RETRY_SCORE: Final[float] = 0.50
MAX_RETRIEVAL_ATTEMPTS: Final[int] = 3

MIN_RERANK_SCORE_TO_KEEP: Final[float] = 0.10
MIN_RELEVANCE_THRESHOLD: Final[float] = 0.3

CRITICAL_CA_THRESHOLD: Final[float] = 0.65

# ================================================================
# Hard Fail & Context Control Flags
# ================================================================
ENABLE_HARD_FAIL_LOGIC: Final[bool] = False
ENABLE_CONTEXTUAL_RULE_OVERRIDE: Final[bool] = True

MAX_EVI_STR_CAP: Final[float] = 10.0
CONTEXT_CAP_L3_PLUS: Final[int] = 60000

# ================================================================
# Chunking Configuration
# ================================================================
CHUNK_SIZE: Final[int] = 1500
CHUNK_OVERLAP: Final[int] = 250
STANDARD_K: Final[int] = 5

QUERY_INITIAL_K: Final[int] = 20

# ================================================================
# Priority & Parallel Processing
# ================================================================
LIMIT_CHUNKS_PER_PRIORITY_DOC: Final[int] = 5
PRIORITY_CHUNK_LIMIT: Final[int] = 30


# ================================================================
# Logging & Context Control
# ================================================================
IS_LOG_L3_CONTEXT: Final[bool] = True
MAX_EVAL_CONTEXT_LENGTH: Final[int] = 3000

# ================================================================
# Supported File & Document Types
# ================================================================
SUPPORTED_TYPES: Final[List[str]] = [
    ".pdf", ".docx", ".txt", ".xlsx", ".pptx", ".md", ".csv",
    ".jpg", ".jpeg", ".png",
]

SUPPORTED_DOC_TYPES: Final[List[str]] = [
    "document", "policy", "report", "statement", "evidence",
    "feedback", "faq", "seam",
]

EVIDENCE_DOC_TYPES: Final[str] = "evidence"
DEFAULT_DOC_TYPES: Final[str] = "document"

# ================================================================
# Enabler & Assessment Constants
# ================================================================
SUPPORTED_ENABLERS: Final[List[str]] = [
    "CG", "SP", "RM&IC", "SCM", "DT", "HCM", "KM", "IM", "IA",
]

MAX_LEVEL: Final[int] = 5
INITIAL_LEVEL: Final[int] = 1

# ================================================================
# SE-AM Enabler Mapping
# ================================================================
SEAM_ENABLER_MAP: Final[Dict[str, str]] = {
    "CG": "1 ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏î‡∏π‡πÅ‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£",
    "SP": "2 ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå",
    "RM&IC": "3 ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô",
    "SCM": "4 ‡∏Å‡∏≤‡∏£‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏™‡∏µ‡∏¢ ‡πÅ‡∏•‡∏∞‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤",
    "DT": "5 ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•",
    "HCM": "6 ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏∏‡∏ô‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå",
    "KM": "7-1 ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ",
    "IM": "7-2 ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°",
    "IA": "8 ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô",
}

# ------------------------------------------------------------------
# SE-AM Sub-topic Mapping (‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤ 3-15 ‡∏Ç‡∏≠‡∏á SE-AM Manual Book 2566)
# ------------------------------------------------------------------
SEAM_SUBTOPIC_MAP = {
    # CG
    "1.1": "CG-1.1", "1-1": "CG-1.1",
    # SP
    "2.1": "SP-2.1", "2-1": "SP-2.1",
    # RM&IC
    "3.1": "RMIC-3.1", "3-1": "RMIC-3.1",
    # SCM
    "4.1": "SCM-4.1", "4-1": "SCM-4.1",
    # DT
    "5.1": "DT-5.1", "5-1": "DT-5.1",
    # HCM
    "6.1": "HCM-6.1", "6-1": "HCM-6.1", "6.2": "HCM-6.2", "6.3": "HCM-6.3", "6.4": "HCM-6.4",
    "6.5": "HCM-6.5", "6.6": "HCM-6.6", "6.7": "HCM-6.7",
    # KM & IM
    "7.1": "KM-7.1", "7-1": "KM-7.1",
    "7.20": "IM-7.20", "7-20": "IM-7.20",
    # IA
    "8.1": "IA-8.1", "8-1": "IA-8.1",
}

# ================================================================
# Paths & Export Configuration
# ================================================================
RUBRIC_FILENAME_PATTERN: Final[str] = "{tenant}_{enabler}_rubric.json"
EXPORTS_DIR: Final[str] = os.path.join(PROJECT_ROOT, "exports")

DOCUMENT_ID_MAPPING_FILENAME_SUFFIX: Final[str] = "_doc_id_mapping.json"
EVIDENCE_MAPPING_FILENAME_SUFFIX: Final[str] = "_evidence_mapping.json"

# ================================================================
# Action Plan Generation Control
# ================================================================
MAX_ACTION_PLAN_PHASES: Final[int] = 3
MAX_STEPS_PER_ACTION: Final[int] = 2
ACTION_PLAN_STEP_MAX_WORDS: Final[int] = 15
ACTION_PLAN_LANGUAGE: Final[str] = "th"  # "th" or "en"

# ================================================================
# PDCA Rules & Scoring
# ================================================================

# ‡πÅ‡∏Å‡πâ‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå core/seam_assessment.py ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ô‡∏µ‡πâ
REQUIRED_PDCA: Final[Dict[int, Set[str]]] = {
    1: {"P"},
    2: {"P", "D"},
    3: {"P", "D", "C"},
    4: {"P", "D", "C", "A"},
    5: {"P", "D", "C", "A"},
}

CORRECT_PDCA_SCORES_MAP: Final[Dict[int, Dict[str, int]]] = {
    1: {"Plan": 1, "Do": 0, "Check": 0, "Act": 0},
    2: {"Plan": 1, "Do": 1, "Check": 0, "Act": 0},
    3: {"Plan": 1, "Do": 1, "Check": 1, "Act": 1},
    4: {"Plan": 2, "Do": 2, "Check": 1, "Act": 1},
    5: {"Plan": 2, "Do": 2, "Check": 2, "Act": 2},
}

PDCA_PHASE_MAP: Final[Dict[int, str]] = {
    1: "Plan (P)",
    2: "Plan (P) + Do (D)",
    3: "Plan (P) + Do (D) + Check (C)",
    4: "Plan (P) + Do (D) + Check (C) + Act (A)",
    5: "PDCA ‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ (P + D + C + A) + Sustainability & Innovation",
}

# ================================================================
# PDCA Heuristic & NLP Helpers
# ================================================================
PDCA_PRIORITY_ORDER: Final[List[str]] = ["Act", "Check", "Do", "Plan"]

# =================================================================
# BASE_PDCA_KEYWORDS (Generic & Professional Version)
# ‡πÄ‡∏ô‡πâ‡∏ô "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£" ‡πÅ‡∏•‡∏∞ "‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á Logic
# =================================================================
BASE_PDCA_KEYWORDS: Final[Dict[str, List[str]]] = {
    "Plan": [
        r"‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢", r"‡πÅ‡∏ú‡∏ô‡πÅ‡∏°‡πà‡∏ö‡∏ó", r"‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", r"‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå", r"‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå",
        r"‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢", r"‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£", r"‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®", r"‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏Å‡∏ì‡∏ë‡πå",
        r"master plan", r"roadmap", r"policy", r"‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£",
        r"‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á", r"‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£", r"‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå", r"‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô"
    ],
    "Do": [
        r"‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô", r"‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥", r"‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥", r"‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°",
        r"‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°", r"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°", r"‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°", r"workshop", 
        r"cop", r"community of practice", r"‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î", r"‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£", 
        r"‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå", r"‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ", r"action plan", r"‡∏Ç‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô", 
        r"‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô", r"‡∏†‡∏≤‡∏û‡∏ñ‡πà‡∏≤‡∏¢‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°", r"‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô", r"‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£"
    ],
    "Check": [
        # ‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à
        r"‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏ú‡∏•", r"kpi", r"‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô", r"‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•", r"‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö",
        r"‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•", r"‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå", r"‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á", r"audit", r"review",
        r"dashboard", r"‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå", r"‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î", r"‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•", r"gap analysis",
        r"evaluation", r"performance", r"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à", r"‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°", r"‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô"
    ],
    "Act": [
        # ‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î Gap ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î (Critical ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Level 4-5)
        r"‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á", r"‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç", r"‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö", r"lesson learned",
        r"corrective action", r"‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç", r"‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞", r"‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ú‡∏•",
        r"best practice", r"‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°", r"innovation", r"‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤",
        r"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô", r"sustainability", r"‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà", r"‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏°‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á",
        r"‡∏ñ‡∏≠‡∏î‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", r"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤", r"re-design", r"self-assessment"
    ],
}

PDCA_LEVEL_SYNONYMS: Final[Dict[int, str]] = {
    1: "‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢, ‡πÅ‡∏ú‡∏ô‡πÅ‡∏°‡πà‡∏ö‡∏ó, ‡∏¢‡∏∏‡∏ó‡∏ò‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå, ‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå, ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢, ‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á, ‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏ö‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢, ‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô",
    2: "‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô, ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£, ‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô, ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö, ‡πÅ‡∏ú‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£, ‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢, ‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°",
    3: "‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏ú‡∏•, ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•, KPI, ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•, Audit, ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö, ‡∏Å‡∏≤‡∏£‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô, ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏•, ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ä‡πâ, ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á (Gap)",
    4: "‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á, Corrective Action, Preventive Action, ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö, ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç, ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ú‡∏ô, ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°, ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞",
    5: "‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô, Best Practice, ‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ú‡∏•, ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß, ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•, External Recognition, ‡∏Å‡∏≤‡∏£‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£"
}

# ================================================================
# Intent & Analysis Signals
# ================================================================
PDCA_ANALYSIS_SIGNALS: Final[List[str]] = [
    "‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå", "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö", "‡∏°‡∏µ pdca ‡πÑ‡∏´‡∏°", "‡∏Ñ‡∏£‡∏ö‡πÑ‡∏´‡∏°",
    "‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô", "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå", "p-d-c-a", "analyze",
    "‡∏Ç‡∏≤‡∏î‡∏≠‡∏∞‡πÑ‡∏£", "‡πÄ‡∏ä‡πá‡∏Ñ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô",
]

ANALYSIS_FRAMEWORK: Final[str] = "PDCA (Plan-Do-Check-Act)"

INSUFFICIENT_DATA_MSG: Final[str] = (
    "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ PDCA"
)
